<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Redux | tombstone</title>
    <meta name="description" content="tombstone docs">
    <link rel="icon" href="/tombstone/favicon.ico">
    
    <link rel="preload" href="/tombstone/assets/css/0.styles.0ea869b6.css" as="style"><link rel="preload" href="/tombstone/assets/js/app.07449c5b.js" as="script"><link rel="preload" href="/tombstone/assets/js/2.152d0674.js" as="script"><link rel="preload" href="/tombstone/assets/js/24.f35e8fdb.js" as="script"><link rel="prefetch" href="/tombstone/assets/js/10.c99679bb.js"><link rel="prefetch" href="/tombstone/assets/js/11.a9162f4a.js"><link rel="prefetch" href="/tombstone/assets/js/12.75d3a72b.js"><link rel="prefetch" href="/tombstone/assets/js/13.345533d3.js"><link rel="prefetch" href="/tombstone/assets/js/14.da0db826.js"><link rel="prefetch" href="/tombstone/assets/js/15.33c80a16.js"><link rel="prefetch" href="/tombstone/assets/js/16.1cc04538.js"><link rel="prefetch" href="/tombstone/assets/js/17.a6878b4f.js"><link rel="prefetch" href="/tombstone/assets/js/18.ff68e5de.js"><link rel="prefetch" href="/tombstone/assets/js/19.b9e1d83f.js"><link rel="prefetch" href="/tombstone/assets/js/20.fc8b8995.js"><link rel="prefetch" href="/tombstone/assets/js/21.9e5426d1.js"><link rel="prefetch" href="/tombstone/assets/js/22.5e35dc36.js"><link rel="prefetch" href="/tombstone/assets/js/23.3fa21b8a.js"><link rel="prefetch" href="/tombstone/assets/js/25.38e332fa.js"><link rel="prefetch" href="/tombstone/assets/js/26.a070590c.js"><link rel="prefetch" href="/tombstone/assets/js/27.49aabf53.js"><link rel="prefetch" href="/tombstone/assets/js/28.4ba83461.js"><link rel="prefetch" href="/tombstone/assets/js/29.c8be879f.js"><link rel="prefetch" href="/tombstone/assets/js/3.46a3affc.js"><link rel="prefetch" href="/tombstone/assets/js/4.42483a9f.js"><link rel="prefetch" href="/tombstone/assets/js/5.d1989c2f.js"><link rel="prefetch" href="/tombstone/assets/js/6.1daef0ca.js"><link rel="prefetch" href="/tombstone/assets/js/7.826394e6.js"><link rel="prefetch" href="/tombstone/assets/js/8.f06b551a.js"><link rel="prefetch" href="/tombstone/assets/js/9.002fbdbb.js">
    <link rel="stylesheet" href="/tombstone/assets/css/0.styles.0ea869b6.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/tombstone/" class="home-link router-link-active"><!----> <span class="site-name">tombstone</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/tombstone/about.html" class="nav-link">about</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/tombstone/about.html" class="nav-link">about</a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/tombstone/" class="sidebar-link">Home</a></li><li><section class="sidebar-group collapsable depth-0"><a href="/tombstone/handbook/" class="sidebar-heading clickable"><span>手册</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group depth-0"><a href="/tombstone/frontend/" class="sidebar-heading clickable router-link-active open"><span>前端技术清单</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/tombstone/frontend/browser/howbrowserworks.html" class="sidebar-link">浏览器是怎么工作的</a></li><li><a href="/tombstone/frontend/performance/" class="sidebar-link">前端性能优化</a></li><li><section class="sidebar-group is-sub-group depth-1"><a href="/tombstone/frontend/javascript/" class="sidebar-heading clickable"><span>JavaScript</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/tombstone/frontend/javascript/howjsworks.html" class="sidebar-link">JS 是怎么工作的</a></li><li><a href="/tombstone/frontend/javascript/crossorigin.html" class="sidebar-link">浏览器同源策略与 ajax 跨域方法</a></li><li><a href="/tombstone/frontend/javascript/jsapi.html" class="sidebar-link">常用 JS API</a></li><li><a href="/tombstone/frontend/javascript/dom.html" class="sidebar-link">DOM</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><a href="/tombstone/frontend/css/" class="sidebar-heading clickable"><span>CSS</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/tombstone/frontend/css/cssom.html" class="sidebar-link">CSSOM</a></li><li><a href="/tombstone/frontend/css/csslayout.html" class="sidebar-link">CSS 布局</a></li><li><a href="/tombstone/frontend/css/bfc.html" class="sidebar-link">Block Formatting Context</a></li></ul></section></li><li><a href="/tombstone/frontend/security/" class="sidebar-link">前端安全问题</a></li><li><a href="/tombstone/frontend/typescript/" class="sidebar-link">TypeScript</a></li><li><section class="sidebar-group is-sub-group depth-1"><a href="/tombstone/frontend/library/" class="sidebar-heading clickable router-link-active open"><span>前端框架</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/tombstone/frontend/library/react.html" class="sidebar-link">React</a></li><li><a href="/tombstone/frontend/library/redux.html" class="active sidebar-link">Redux</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/tombstone/frontend/library/redux.html#使用" class="sidebar-link">使用</a></li><li class="sidebar-sub-header"><a href="/tombstone/frontend/library/redux.html#api" class="sidebar-link">API</a></li><li class="sidebar-sub-header"><a href="/tombstone/frontend/library/redux.html#和-react-绑定" class="sidebar-link">和 React 绑定</a></li><li class="sidebar-sub-header"><a href="/tombstone/frontend/library/redux.html#简单实现" class="sidebar-link">简单实现</a></li><li class="sidebar-sub-header"><a href="/tombstone/frontend/library/redux.html#参考文档" class="sidebar-link">参考文档</a></li></ul></li><li><a href="/tombstone/frontend/library/reactimvc.html" class="sidebar-link">React-IMVC</a></li><li><a href="/tombstone/frontend/library/immer.html" class="sidebar-link">Immer</a></li></ul></section></li></ul></section></li><li><a href="/tombstone/blog/" class="sidebar-link">文章</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="redux"><a href="#redux" aria-hidden="true" class="header-anchor">#</a> Redux</h1> <p>Redux is a predictable state container for JavaScript apps.</p> <ul><li>单一数据源（store）</li> <li>state 是只读的(通过触发 action 来修改 state)</li> <li>使用纯函数来执行修改（reducer）</li></ul> <h2 id="使用"><a href="#使用" aria-hidden="true" class="header-anchor">#</a> 使用</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> createStore <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'redux'</span>

<span class="token comment">/**
 * This is a reducer, a pure function with (state, action) =&gt; state signature.
 */</span>
<span class="token keyword">function</span> <span class="token function">counter</span><span class="token punctuation">(</span><span class="token parameter">state <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> action</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">switch</span> <span class="token punctuation">(</span>action<span class="token punctuation">.</span>type<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">case</span> <span class="token string">'INCREMENT'</span><span class="token punctuation">:</span>
      <span class="token keyword">return</span> state <span class="token operator">+</span> <span class="token number">1</span>
    <span class="token keyword">case</span> <span class="token string">'DECREMENT'</span><span class="token punctuation">:</span>
      <span class="token keyword">return</span> state <span class="token operator">-</span> <span class="token number">1</span>
    <span class="token keyword">default</span><span class="token punctuation">:</span>
      <span class="token keyword">return</span> state
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// Its API is { subscribe, dispatch, getState }.</span>
<span class="token keyword">let</span> store <span class="token operator">=</span> <span class="token function">createStore</span><span class="token punctuation">(</span>counter<span class="token punctuation">)</span>

<span class="token comment">// You can use subscribe() to update the UI in response to state changes.</span>
<span class="token comment">// Normally you'd use a view binding library (e.g. React Redux) rather than subscribe() directly.</span>
<span class="token comment">// However it can also be handy to persist the current state in the localStorage.</span>
store<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>store<span class="token punctuation">.</span><span class="token function">getState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">// The only way to mutate the internal state is to dispatch an action.</span>
<span class="token comment">// The actions can be serialized, logged or stored and later replayed.</span>
store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token punctuation">{</span> type<span class="token punctuation">:</span> <span class="token string">'INCREMENT'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">// 1</span>
store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token punctuation">{</span> type<span class="token punctuation">:</span> <span class="token string">'INCREMENT'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">// 2</span>
store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token punctuation">{</span> type<span class="token punctuation">:</span> <span class="token string">'DECREMENT'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">// 1</span>
</code></pre></div><h2 id="api"><a href="#api" aria-hidden="true" class="header-anchor">#</a> API</h2> <ul><li>createStore
<ul><li><code>createStore(reducer, [preloadedState], enhancer)</code></li></ul></li> <li>store
<ul><li>{ getState, subscribe, dispatch }
<ul><li>store.getState() 获取 state</li> <li>store.subscribe(fn) 添加订阅，每次 dispatch action 时执行 fn</li> <li>store.dispatch(action) 触发 action
<ul><li>action: { type, payload }</li> <li>内部执行 <code>currentState = currentReducer(currentState, action)</code>， 并触发所有 subscribe 添加的订阅</li></ul></li></ul></li> <li>是 createStore 的返回值</li></ul></li> <li>combineReducers
<ul><li><code>let reducer = combineReducers({key1: reducer1, key2: reducer2})</code></li> <li>将多个 reducer 组合成一个 reducer, 作为 createStore 的第一个参数</li> <li>state[key1] 对应于 reducer1</li></ul></li> <li>bindActionCreators
<ul><li><code>bindActionCreators(actionCreators, dispatch)</code></li></ul></li> <li>applyMiddleware
<ul><li>todo</li></ul></li> <li>compose
<ul><li>compose(f, g, h)  相当于  (...args) =&gt; f(g(h(...args)))</li></ul></li></ul> <h2 id="和-react-绑定"><a href="#和-react-绑定" aria-hidden="true" class="header-anchor">#</a> 和 React 绑定</h2> <p>todo</p> <h2 id="简单实现"><a href="#简单实现" aria-hidden="true" class="header-anchor">#</a> 简单实现</h2> <p><a href="https://github.com/shenxinle/js-snippets/blob/master/src/redux/index.js" target="_blank" rel="noopener noreferrer">https://github.com/shenxinle/js-snippets/blob/master/src/redux/index.js<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h2 id="参考文档"><a href="#参考文档" aria-hidden="true" class="header-anchor">#</a> 参考文档</h2> <ul><li><a href="https://github.com/reduxjs/redux" target="_blank" rel="noopener noreferrer">https://github.com/reduxjs/redux<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/tombstone/frontend/library/react.html" class="prev">React</a></span> <span class="next"><a href="/tombstone/frontend/library/reactimvc.html">React-IMVC</a>→
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/tombstone/assets/js/app.07449c5b.js" defer></script><script src="/tombstone/assets/js/2.152d0674.js" defer></script><script src="/tombstone/assets/js/24.f35e8fdb.js" defer></script>
  </body>
</html>
